# CVE Reporting

This repo contains the notebooks and working files for the Smart Columbus Connected Vehicle Environment reporting effort

## Running locally

### Requirements:
+ Python (https://www.python.org/downloads/)
+ Poetry (https://python-poetry.org/docs/#installation)

```poetry install```

```poetry run jupyter notebook```

> Note: Most of the notebooks and reports in this repo assume that you have direct access to the Presto database behind the OS. This is accomplished by port-forwarding the coordinator. See the k8s docs for more information or use k9s' shortcuts.

## Running remotely

> These steps have not been rigorously tested in all situations

```sh
# Create the deployment
kubectl create deployment --image=python:3.9.1-buster cve-reporter

# Find the pod name
kubectl get pods

# Copy the app code to the pod
kubectl cp app/*.py default/cve-reporter-745f5db67d-p6r8v:/app

# Exec into pod
kubectl exec -it cve-reporter-745f5db67d-p6r8v -- bin/bash

# Install poetry
pip install --user poetry

# Install dependencies
poetry install

# Get into the poetry shell
poetry shell

# Run whatever report is necessary
python rlr_report.py
```

Logs from the reports will be found in a file called `cve.log`. If connection to the pod is lost, the process will continue running and its progress can be checked by reconnecting and checking the log file. The current query can be seen in the presto console.